document.addEventListener("DOMContentLoaded",function(){let e=document.getElementById("emailStep"),t=document.getElementById("passwordStep"),o=document.getElementById("continueBtn"),r=document.getElementById("submitBtn"),n=document.getElementById("emailInput"),l=document.querySelector('input[name="password"]'),i=document.getElementById("editEmail"),s=document.querySelector(".hr-with-text"),a=document.querySelector(".social-login-buttons"),d=document.getElementById("forgotPassword");document.getElementById("loginForm"),o.addEventListener("click",function(l){l.preventDefault();let c=n.value;fetch("/login.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"},body:`action=checkEmail&Gmail=${encodeURIComponent(c)}`}).then(e=>e.text()).then(l=>{console.log(l);let c=JSON.parse(l);c.success?(e.style.display="block",t.style.display="block",o.style.display="none",r.style.display="inline-block",i.style.display="inline-block",n.readOnly=!0,d.style.display="block",s&&(s.style.display="none"),a&&(a.style.display="none")):Swal.fire({icon:"error",title:"Error",text:c.message})}).catch(e=>{console.error("Error:",e),Swal.fire({icon:"error",title:"Error",text:"Hubo un problema al procesar su solicitud. Por favor, int\xe9ntelo de nuevo."})})}),r.addEventListener("click",function(e){var t;e.preventDefault();let o=n.value.trim(),r=l.value;if(!o||!r){Swal.fire({icon:"error",title:"Campos vac\xedos",text:"Por favor, complete todos los campos."});return}if(t=o,!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)){Swal.fire({icon:"error",title:"Email inv\xe1lido",text:"Por favor, ingrese un email v\xe1lido."});return}fetch("/login.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"},body:`action=login&Gmail=${encodeURIComponent(o)}&password=${encodeURIComponent(r)}`}).then(e=>{if(!e.ok)throw Error("Network response was not ok");return e.json()}).then(e=>{console.log("Server response:",e),e.success?(console.log("Redirect URL:",e.redirect),Swal.fire({icon:"success",title:"\xa1Bienvenido!",text:"Has iniciado sesi\xf3n correctamente.",showConfirmButton:!1,timer:1500}).then(()=>{console.log("Redirecting to:",e.redirect||"/Index.php"),window.location.href=e.redirect||"/Index.php"})):Swal.fire({icon:"error",title:"Error",text:e.message||"Hubo un problema al iniciar sesi\xf3n."})}).catch(e=>{console.error("Error:",e),Swal.fire({icon:"error",title:"Error",text:"Hubo un problema al procesar su solicitud. Por favor, int\xe9ntelo de nuevo."})})}),i.addEventListener("click",function(c){c.preventDefault(),e.style.display="block",t.style.display="none",o.style.display="inline-block",r.style.display="none",i.style.display="none",n.readOnly=!1,d.style.display="none",s&&(s.style.display="block"),a&&(a.style.display="block"),l.value="",n.focus()})});